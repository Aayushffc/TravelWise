<div class="min-h-screen bg-gray-100">
  <!-- Navigation Bar -->
  <nav class="bg-white shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex">
          <button (click)="goBack()" class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-gray-500 bg-white hover:text-gray-700 focus:outline-none transition">
            <svg class="h-5 w-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            Back
          </button>
        </div>
        <div class="flex items-center">
          <button
            (click)="toggleEdit()"
            class="edit-toggle inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white"
            [class.active]="isEditing"
            [ngClass]="isEditing ? 'bg-red-600 hover:bg-red-700' : 'bg-indigo-600 hover:bg-indigo-700'"
          >
            <svg *ngIf="!isEditing" class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
            </svg>
            <svg *ngIf="isEditing" class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
            {{ isEditing ? 'Cancel Edit' : 'Edit Deal' }}
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center py-12">
    <div class="loading-spinner rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <div class="error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
      <span class="block sm:inline">{{ error }}</span>
    </div>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <div class="success-message bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative" role="alert">
      <span class="block sm:inline">{{ successMessage }}</span>
    </div>
  </div>

  <!-- Deal Content -->
  <div *ngIf="!isLoading && deal" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Title and Booking Section -->
    <div class="grid grid-cols-1 gap-8 mb-8">
      <!-- Title and Basic Info -->
      <div class="bg-white rounded-lg shadow-sm p-6">
        <div class="relative">
          <h1 *ngIf="!isEditing" class="text-3xl font-bold text-gray-900">{{ deal.title }}</h1>
          <div *ngIf="isEditing" class="form-group">
            <input
              type="text"
              [(ngModel)]="deal.title"
              class="form-control w-full text-3xl font-bold border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500"
              placeholder="Deal Title"
            >
          </div>

          <!-- Location and Price Section -->
          <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Location -->
            <div class="location-display">
              <svg class="h-5 w-5 location-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              <span *ngIf="!isEditing" class="text-lg">{{ deal.location?.name || 'No location set' }}</span>
              <select *ngIf="isEditing"
                      [(ngModel)]="deal.locationId"
                      class="form-control">
                <option [ngValue]="null">Select a location</option>
                <option *ngFor="let loc of locations" [value]="loc.id">{{ loc.name }}</option>
              </select>
            </div>

            <!-- Price -->
            <div class="flex flex-col items-end">
              <div *ngIf="!isEditing" class="text-right">
                <div class="price-display" *ngIf="deal.discountedPrice && deal.discountedPrice < deal.price">
                  <span class="discounted-price">{{ deal.discountedPrice | currency }}</span>
                  <span class="original-price ml-2">{{ deal.price | currency }}</span>
                </div>
                <div class="price-display" *ngIf="!deal.discountedPrice || deal.discountedPrice >= deal.price">
                  {{ deal.price | currency }}
                </div>
                <div class="text-sm text-green-600" *ngIf="deal.discountPercentage > 0">
                  Save {{ deal.discountPercentage }}%
                </div>
              </div>
              <div *ngIf="isEditing" class="w-full space-y-4">
                <div class="flex items-center space-x-4">
                  <div class="flex-1">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Price</label>
                    <input type="number"
                           [(ngModel)]="deal.price"
                           (ngModelChange)="updateDiscountedPrice()"
                           class="form-control"
                           min="0"
                           step="0.01">
                  </div>
                  <div class="flex-1">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Discount %</label>
                    <input type="number"
                           [(ngModel)]="deal.discountPercentage"
                           (ngModelChange)="updateDiscountedPrice()"
                           class="form-control"
                           min="0"
                           max="100">
                  </div>
                </div>
                <div class="text-right text-sm text-gray-600">
                  Discounted Price: {{ deal.discountedPrice | currency }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Photo Gallery -->
    <div class="bg-white rounded-lg shadow-sm overflow-hidden mb-8 card">
      <div class="relative h-[500px] gallery-container">
        <!-- Main Image -->
        <img
          *ngIf="deal.photos && deal.photos.length > 0"
          [src]="deal.photos[currentImageIndex]"
          class="w-full h-full object-cover"
          alt="Deal photo"
          (error)="handleImageError($event)"
        >
        <div *ngIf="!deal.photos || deal.photos.length === 0" class="w-full h-full flex items-center justify-center bg-gray-100">
          <div class="text-center text-gray-500">
            <svg class="mx-auto h-12 w-12 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <p>No photos added yet</p>
          </div>
        </div>

        <!-- Navigation Arrows -->
        <button
          *ngIf="deal.photos && deal.photos.length > 1 && currentImageIndex > 0"
          (click)="previousImage()"
          class="nav-arrow absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 z-10"
        >
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </button>
        <button
          *ngIf="deal.photos && deal.photos.length > 1 && currentImageIndex < deal.photos.length - 1"
          (click)="nextImage()"
          class="nav-arrow absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75 z-10"
        >
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
        </button>
      </div>

      <!-- Thumbnail Strip -->
      <div class="p-4 bg-gray-50">
        <div class="flex items-center space-x-4 overflow-x-auto pb-2"
             cdkDropList
             [cdkDropListData]="deal.photos || []"
             (cdkDropListDropped)="onPhotoReorder($event)">
          <div
            *ngFor="let photo of deal.photos; let i = index"
            class="thumbnail relative flex-shrink-0 w-24 h-24 group"
            [class.active]="i === currentImageIndex"
            cdkDrag
            [cdkDragDisabled]="!isEditing"
          >
            <img
              [src]="photo"
              class="w-full h-full object-cover rounded-lg cursor-move"
              alt="Thumbnail"
              (error)="handleImageError($event)"
              (click)="selectImage(i)"
            >
            <!-- Delete Photo Button -->
            <button
              *ngIf="isEditing"
              (click)="removePhoto(i); $event.stopPropagation()"
              class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"
            >
              <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
            <!-- Drag Handle -->
            <div *ngIf="isEditing" class="cdkDragHandle absolute bottom-0 left-0 right-0 h-6 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
              <svg class="h-4 w-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9h8M8 15h8" />
              </svg>
            </div>
          </div>

          <!-- Add Photo Button -->
          <div *ngIf="isEditing" class="relative flex-shrink-0 w-24 h-24">
            <label class="cursor-pointer w-full h-full flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg hover:border-indigo-500 transition-colors">
              <div class="text-center">
                <svg class="mx-auto h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
              </div>
              <input type="file" class="hidden" multiple accept="image/*" (change)="handleFileInput($event)">
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Deal Information -->
    <div class="bg-white rounded-lg shadow-sm overflow-hidden card">
      <div class="p-6">
        <!-- Package Type and Save Button -->
        <div class="mb-6">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
              <div *ngIf="!isEditing"
                   class="status-badge inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"
                   [ngClass]="{
                     'bg-green-100 text-green-800': deal.packageType === 'STANDARD',
                     'bg-blue-100 text-blue-800': deal.packageType === 'PREMIUM',
                     'bg-purple-100 text-purple-800': deal.packageType === 'LUXURY'
                   }">
                {{ deal.packageType }}
              </div>
              <select *ngIf="isEditing"
                      [(ngModel)]="deal.packageType"
                      class="form-control rounded-md border-gray-300 w-64">
                <option *ngFor="let type of packageTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
            <button *ngIf="isEditing"
                    (click)="saveDeal()"
                    class="save-button inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
              <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              Save Changes
            </button>
          </div>
        </div>

        <!-- Description -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Description</h2>
          <div *ngIf="!isEditing" class="text-gray-600 prose max-w-none">{{ deal.description }}</div>
          <textarea
            *ngIf="isEditing"
            [(ngModel)]="deal.description"
            rows="4"
            class="form-control w-full border-gray-300 rounded-md"
            placeholder="Write a detailed description of the deal..."
          ></textarea>
        </div>

        <!-- Location and Duration -->
        <div class="mb-6">
          <div class="flex flex-wrap gap-4">
            <div class="feature-card flex items-center p-3 rounded-lg bg-gray-50 border border-gray-200">
              <svg class="h-5 w-5 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <div class="flex items-center">
                <span *ngIf="!isEditing" class="text-gray-600">{{ deal.daysCount }} Days / {{ deal.nightsCount }} Nights</span>
                <div *ngIf="isEditing" class="flex items-center space-x-2">
                  <input
                    type="number"
                    [(ngModel)]="deal.daysCount"
                    class="form-control w-16 text-center border-gray-300 rounded-md"
                    min="1"
                  >
                  <span class="text-gray-600">Days /</span>
                  <input
                    type="number"
                    [(ngModel)]="deal.nightsCount"
                    class="form-control w-16 text-center border-gray-300 rounded-md"
                    min="0"
                  >
                  <span class="text-gray-600">Nights</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Package Options Section -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Package Options</h2>
          <div class="space-y-4">
            <div *ngFor="let option of deal.packageOptions || []; let i = index"
                 class="bg-white rounded-lg shadow-sm p-4 border border-gray-200">
              <div class="flex justify-between items-start mb-4">
                <h3 class="text-lg font-medium text-gray-900">Option {{i + 1}}</h3>
                <button *ngIf="isEditing" (click)="removePackageOption(i)"
                        class="text-red-600 hover:text-red-800 transition-colors">
                  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                  <input *ngIf="isEditing" type="text" [(ngModel)]="option.name"
                         class="form-control w-full" placeholder="Option name">
                  <span *ngIf="!isEditing" class="text-gray-600">{{option.name || 'No name set'}}</span>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Price</label>
                  <input *ngIf="isEditing" type="number" [(ngModel)]="option.price"
                         class="form-control w-full" min="0" step="0.01">
                  <span *ngIf="!isEditing" class="text-gray-600">{{option.price | currency}}</span>
                </div>
              </div>

              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                <textarea *ngIf="isEditing" [(ngModel)]="option.description" rows="2"
                          class="form-control w-full" placeholder="Option description"></textarea>
                <p *ngIf="!isEditing" class="text-gray-600">{{option.description || 'No description set'}}</p>
              </div>

              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Inclusions</label>
                <div class="flex flex-wrap gap-2 mt-2">
                  <div *ngFor="let inclusion of option.inclusions || []; let j = index; trackBy: trackByIndex"
                       class="inline-flex items-center bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                    <span *ngIf="!isEditing">{{inclusion}}</span>
                    <div *ngIf="isEditing" class="flex items-center">
                      <input
                        type="text"
                        [(ngModel)]="option.inclusions![j]"
                        name="inclusion-{{ j }}"
                        class="bg-transparent border-0 focus:ring-0 p-0 text-sm w-full"
                      >
                      <button
                        (click)="removeInclusion(option, j)"
                        class="ml-1 text-purple-600 hover:text-purple-800"
                      >
                        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                      </button>
                    </div>
                  </div>
                  <button
                    *ngIf="isEditing"
                    (click)="addInclusion(option)"
                    class="inline-flex items-center px-3 py-1 border border-purple-300 rounded-full text-sm text-purple-600 bg-white hover:bg-purple-50 transition-colors"
                  >
                    <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    Add Inclusion
                  </button>
                </div>
              </div>
            </div>

            <button
              *ngIf="isEditing"
              (click)="addPackageOption()"
              class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"
            >
              <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
              </svg>
              Add Package Option
            </button>
          </div>
        </div>

        <!-- Itinerary Section -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Itinerary</h2>
          <div class="space-y-4">
            <div *ngFor="let day of deal.itinerary || []; let i = index"
                 class="bg-white rounded-lg shadow-sm p-4 border border-gray-200">
              <div class="flex justify-between items-start mb-4">
                <h3 class="text-lg font-medium text-gray-900">Day {{day.dayNumber}}</h3>
                <button *ngIf="isEditing" (click)="removeItineraryDay(i)"
                        class="text-red-600 hover:text-red-800 transition-colors">
                  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                  <input *ngIf="isEditing" type="text" [(ngModel)]="day.title"
                         class="form-control w-full" placeholder="Day title">
                  <span *ngIf="!isEditing" class="text-gray-600">{{day.title || 'No title set'}}</span>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                  <textarea *ngIf="isEditing" [(ngModel)]="day.description" rows="3"
                            class="form-control w-full" placeholder="Day description"></textarea>
                  <p *ngIf="!isEditing" class="text-gray-600">{{day.description || 'No description set'}}</p>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Activities</label>
                  <div class="space-y-2">
                    <div *ngFor="let activity of day.activities || []; let j = index; trackBy: trackByIndex"
                         class="flex items-center space-x-2">
                      <input *ngIf="isEditing"
                             type="text"
                             [(ngModel)]="day.activities![j]"
                             name="activity-{{ j }}"
                             class="form-control flex-1"
                             placeholder="Activity">
                      <span *ngIf="!isEditing" class="text-gray-600">{{activity}}</span>
                      <button *ngIf="isEditing"
                              (click)="removeActivity(day, j)"
                              class="text-red-600 hover:text-red-800">
                        <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                      </button>
                    </div>
                    <button *ngIf="isEditing"
                            (click)="addActivity(day)"
                            class="inline-flex items-center px-3 py-1 border border-indigo-300 rounded-md text-sm text-indigo-600 bg-white hover:bg-indigo-50 transition-colors">
                      <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                      </svg>
                      Add Activity
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <button *ngIf="isEditing"
                    (click)="addItineraryDay()"
                    class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors">
              <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
              </svg>
              Add Day
            </button>
          </div>
        </div>

        <!-- Policies Section -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Policies</h2>
          <div class="space-y-4">
            <div *ngFor="let policy of deal.policies || []; let i = index"
                 class="bg-white rounded-lg shadow-sm p-4 border border-gray-200">
              <div class="flex justify-between items-start mb-4">
                <h3 class="text-lg font-medium text-gray-900">Policy {{i + 1}}</h3>
                <button *ngIf="isEditing" (click)="removePolicy(i)"
                        class="text-red-600 hover:text-red-800 transition-colors">
                  <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                  <input *ngIf="isEditing" type="text" [(ngModel)]="policy.title"
                         class="form-control w-full" placeholder="Policy title">
                  <span *ngIf="!isEditing" class="text-gray-600">{{policy.title || 'No title set'}}</span>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                  <textarea *ngIf="isEditing" [(ngModel)]="policy.description" rows="3"
                            class="form-control w-full" placeholder="Policy description"></textarea>
                  <p *ngIf="!isEditing" class="text-gray-600">{{policy.description || 'No description set'}}</p>
                </div>
              </div>
            </div>

            <button
              *ngIf="isEditing"
              (click)="addPolicy()"
              class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"
            >
              <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
              </svg>
              Add Policy
            </button>
          </div>
        </div>

        <!-- Status Section -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Deal Status</h2>
          <div class="flex items-center space-x-4">
            <div class="flex items-center">
              <div class="relative inline-block w-10 mr-2 align-middle select-none">
                <input
                  type="checkbox"
                  id="isActive"
                  [(ngModel)]="deal.isActive"
                  [disabled]="!isEditing"
                  class="checked:bg-indigo-600 outline-none focus:outline-none right-4 checked:right-0 duration-200 ease-in absolute block w-6 h-6 rounded-full bg-white border-4 border-gray-300 appearance-none cursor-pointer"
                />
                <label for="isActive" class="block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
              </div>
              <label for="isActive" class="text-sm font-medium text-gray-700">
                {{ deal.isActive ? 'Active' : 'Inactive' }}
              </label>
            </div>
            <div *ngIf="!isEditing" [class]="deal.isActive ? 'px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800' : 'px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800'">
              {{ deal.isActive ? 'Live' : 'Hidden' }}
            </div>
          </div>
        </div>

        <!-- Additional Details Section -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Additional Details</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Features Section -->
            <div class="col-span-2">
              <h3 class="text-lg font-medium text-gray-900 mb-3">Features</h3>
              <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Elderly Friendly -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.elderlyFriendly"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Elderly Friendly</span>
                  </label>
                </div>

                <!-- Internet Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.internetIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Internet Included</span>
                  </label>
                </div>

                <!-- Travel Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.travelIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Travel Included</span>
                  </label>
                </div>

                <!-- Meals Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.mealsIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Meals Included</span>
                  </label>
                </div>

                <!-- Sightseeing Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.sightseeingIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Sightseeing Included</span>
                  </label>
                </div>

                <!-- Stay Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.stayIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Stay Included</span>
                  </label>
                </div>

                <!-- Air Transfer -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.airTransfer"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Air Transfer</span>
                  </label>
                </div>

                <!-- Road Transfer -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.roadTransfer"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Road Transfer</span>
                  </label>
                </div>

                <!-- Train Transfer -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.trainTransfer"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Train Transfer</span>
                  </label>
                </div>

                <!-- Travel Cost Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.travelCostIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Travel Cost Included</span>
                  </label>
                </div>

                <!-- Guide Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.guideIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Guide Included</span>
                  </label>
                </div>

                <!-- Photography Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.photographyIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Photography Included</span>
                  </label>
                </div>

                <!-- Insurance Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.insuranceIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Insurance Included</span>
                  </label>
                </div>

                <!-- Visa Included -->
                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-200 hover:shadow-md hover:border-gray-300">
                  <label class="flex items-center space-x-3 cursor-pointer">
                    <input type="checkbox"
                           [(ngModel)]="deal.visaIncluded"
                           [disabled]="!isEditing"
                           class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                    <span class="text-gray-700">Visa Included</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Group Size -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Group Size</label>
              <div class="flex items-center space-x-4">
                <div class="flex-1">
                  <label class="text-xs text-gray-500">Minimum</label>
                  <input
                    type="number"
                    [(ngModel)]="deal.minGroupSize"
                    [readonly]="!isEditing"
                    class="form-control w-full border-gray-300 rounded-md"
                    min="1"
                  >
                </div>
                <div class="flex-1">
                  <label class="text-xs text-gray-500">Maximum</label>
                  <input
                    type="number"
                    [(ngModel)]="deal.maxGroupSize"
                    [readonly]="!isEditing"
                    class="form-control w-full border-gray-300 rounded-md"
                    min="1"
                  >
                </div>
              </div>
            </div>

            <!-- Difficulty Level -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Difficulty Level</label>
              <select
                [(ngModel)]="deal.difficultyLevel"
                [disabled]="!isEditing"
                class="form-control w-full border-gray-300 rounded-md"
              >
                <option value="EASY">Easy</option>
                <option value="MODERATE">Moderate</option>
                <option value="CHALLENGING">Challenging</option>
                <option value="DIFFICULT">Difficult</option>
              </select>
            </div>

            <!-- Validity Period -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Valid From</label>
              <input
                type="date"
                [(ngModel)]="deal.validFrom"
                [readonly]="!isEditing"
                class="form-control w-full border-gray-300 rounded-md"
              >
            </div>

            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Valid Until</label>
              <input
                type="date"
                [(ngModel)]="deal.validUntil"
                [readonly]="!isEditing"
                class="form-control w-full border-gray-300 rounded-md"
              >
            </div>

            <!-- Deal Options -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Deal Options</label>
              <div class="flex flex-col space-y-2">
                <label class="inline-flex items-center">
                  <input
                    type="checkbox"
                    [(ngModel)]="deal.isInstantBooking"
                    [disabled]="!isEditing"
                    class="form-checkbox h-4 w-4 text-indigo-600"
                  >
                  <span class="ml-2 text-sm text-gray-700">Instant Booking</span>
                </label>
                <label class="inline-flex items-center">
                  <input
                    type="checkbox"
                    [(ngModel)]="deal.isLastMinuteDeal"
                    [disabled]="!isEditing"
                    class="form-checkbox h-4 w-4 text-indigo-600"
                  >
                  <span class="ml-2 text-sm text-gray-700">Last Minute Deal</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Tags and Categories -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Tags and Categories</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Headline -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Headline</label>
              <div *ngIf="!isEditing" class="text-gray-600">{{ deal.headlines || 'No headline set' }}</div>
              <input *ngIf="isEditing"
                     type="text"
                     [(ngModel)]="deal.headlines"
                     class="form-control w-full"
                     placeholder="Enter a catchy headline">
            </div>

            <!-- Rating Display (Read-only) -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Rating</label>
              <div class="flex items-center space-x-2">
                <div class="flex items-center">
                  <span class="text-yellow-400 mr-1">â˜…</span>
                  <span class="text-gray-600">{{ deal.rating || 0 }} / 5</span>
                </div>
                <span class="text-sm text-gray-500">(Rating is calculated automatically)</span>
              </div>
            </div>

            <!-- Tags -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Tags</label>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let tag of deal.tags || []; let i = index; trackBy: trackByIndex"
                     class="inline-flex items-center bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm">
                  <span *ngIf="!isEditing">{{ tag }}</span>
                  <div *ngIf="isEditing" class="flex items-center">
                    <input
                      type="text"
                      [(ngModel)]="deal.tags![i]"
                      name="tag-{{ i }}"
                      class="bg-transparent border-0 focus:ring-0 p-0 text-sm w-full"
                    >
                    <button
                      (click)="removeTag(i)"
                      class="ml-1 text-indigo-600 hover:text-indigo-800"
                    >
                      <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <button
                  *ngIf="isEditing"
                  (click)="addTag()"
                  class="inline-flex items-center px-3 py-1 border border-indigo-300 rounded-full text-sm text-indigo-600 bg-white hover:bg-indigo-50 transition-colors"
                >
                  <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  Add Tag
                </button>
              </div>
            </div>

            <!-- Seasons -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Seasons</label>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let season of deal.seasons || []; let i = index"
                     class="inline-flex items-center bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">
                  <span *ngIf="!isEditing">{{ season }}</span>
                  <div *ngIf="isEditing" class="flex items-center">
                    <select
                      [value]="season"
                      (change)="handleSeasonInput($event, i)"
                      class="bg-transparent border-0 focus:ring-0 p-0 text-sm"
                    >
                      <option value="SPRING">Spring</option>
                      <option value="SUMMER">Summer</option>
                      <option value="AUTUMN">Autumn</option>
                      <option value="WINTER">Winter</option>
                    </select>
                    <button
                      (click)="removeSeason(i)"
                      class="ml-1 text-green-600 hover:text-green-800"
                    >
                      <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <button
                  *ngIf="isEditing"
                  (click)="addSeason()"
                  class="inline-flex items-center px-3 py-1 border border-green-300 rounded-full text-sm text-green-600 bg-white hover:bg-green-50 transition-colors"
                >
                  <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  Add Season
                </button>
              </div>
            </div>

            <!-- Languages -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Languages</label>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let language of deal.languages; let i = index; trackBy: trackByIndex"
                    class="inline-flex items-center bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                  <span *ngIf="!isEditing">{{ language }}</span>
                  <div *ngIf="isEditing" class="flex items-center">
                    <input
                      type="text"
                      [(ngModel)]="deal.languages![i]"
                      name="language-{{ i }}"
                      class="bg-transparent border-0 focus:ring-0 p-0 text-sm w-full"
                    >
                    <button
                      (click)="removeLanguage(i)"
                      class="ml-1 text-blue-600 hover:text-blue-800"
                    >
                      <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <!-- Add button -->
                <button
                  *ngIf="isEditing"
                  (click)="addLanguage()"
                  class="inline-flex items-center px-3 py-1 border border-blue-300 rounded-full text-sm text-blue-600 bg-white hover:bg-blue-50 transition-colors"
                >
                  <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  Add Language
                </button>
              </div>
            </div>

            <!-- Requirements -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Requirements</label>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let req of deal.requirements || []; let i = index; trackBy: trackByIndex"
                     class="inline-flex items-center bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm">
                  <span *ngIf="!isEditing">{{ req }}</span>
                  <div *ngIf="isEditing" class="flex items-center">
                    <input
                      type="text"
                      [(ngModel)]="deal.requirements![i]"
                      name="requirement-{{ i }}"
                      class="bg-transparent border-0 focus:ring-0 p-0 text-sm w-full"
                    >
                    <button
                      (click)="removeRequirement(i)"
                      class="ml-1 text-yellow-600 hover:text-yellow-800"
                    >
                      <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <button
                  *ngIf="isEditing"
                  (click)="addRequirement()"
                  class="inline-flex items-center px-3 py-1 border border-yellow-300 rounded-full text-sm text-yellow-600 bg-white hover:bg-yellow-50 transition-colors"
                >
                  <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  Add Requirement
                </button>
              </div>
            </div>

            <!-- Restrictions -->
            <div class="space-y-2">
              <label class="block text-sm font-medium text-gray-700">Restrictions</label>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let restriction of deal.restrictions || []; let i = index; trackBy: trackByIndex"
                     class="inline-flex items-center bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm">
                  <span *ngIf="!isEditing">{{ restriction }}</span>
                  <div *ngIf="isEditing" class="flex items-center">
                    <input
                      type="text"
                      [(ngModel)]="deal.restrictions![i]"
                      name="restriction-{{ i }}"
                      class="bg-transparent border-0 focus:ring-0 p-0 text-sm w-full"
                    >
                    <button
                      (click)="removeRestriction(i)"
                      class="ml-1 text-red-600 hover:text-red-800"
                    >
                      <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <button
                  *ngIf="isEditing"
                  (click)="addRestriction()"
                  class="inline-flex items-center px-3 py-1 border border-red-300 rounded-full text-sm text-red-600 bg-white hover:bg-red-50 transition-colors"
                >
                  <svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                  </svg>
                  Add Restriction
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Map URL -->
        <div class="mb-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-3">Location Map</h2>
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700">Map URL</label>
            <input
              type="url"
              [(ngModel)]="deal!.mapUrl"
              [readonly]="!isEditing"
              class="form-control w-full border-gray-300 rounded-md"
              placeholder="Enter Google Maps or other map service URL"
            >
          </div>
        </div>
      </div>
    </div>
  </div>
